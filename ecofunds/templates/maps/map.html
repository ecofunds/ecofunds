{% load tags cms_tags sekizai_tags static i18n %}
{%block head%}
    {% addtoblock "css" %}
        <link type="text/css" rel="stylesheet" href="{% get_static_prefix %}css/ui-custom-theme/jquery-ui-1.9.2.custom.css" />
        <style type="text/css">
          .map-wrapper {
            height: 400px;
          }
        .labels {
            color: white;
            font-family: "Lucida Grande", "Arial", sans-serif;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            width: 100px;
            "border: 2px solid black;"
            white-space: nowrap;
        }
        </style>
    {% endaddtoblock %}

    {% addtoblock "js" %}
        {{ form.media.js }}
        <script type="text/javascript"
            src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart'],'language':'pt'}]}">
        </script>
        <script type="text/javascript">
            var default_domain = 'investment';
            var default_map_type = 'density/';
        </script>
        <script src="{% get_static_prefix %}js/handlebars.1.0.0.beta.3.js"></script>
        <script data-main="{% get_static_prefix %}js/app.js" src="{% get_static_prefix %}js/require.js"></script>
    {% endaddtoblock %}
{% endblock %}

{% if instance.show_search_projects or instance.show_search_organizations or instance.show_search_investments %}
    <script type="text/javascript">
        var global_map_height = 583;
        var default_domain = 'project';
        var default_map_type = 'marker/';
    </script>
    <!-- area-site -->
    <div class="area-site">
        <div class="container">
            <h2 class="ico ico-texto mapa-maior-branco">{% trans "Navigate Map" %}</h2>
        </div>
    </div>
    <!-- fim area-site -->

    <div class="container">
        <div class="area-filtros-mapa">
            <div class="menu-abas">
                <ul class="menu-abas-container">
                    {% if instance.show_search_projects %}<li class="item aba"><a class="link-aba" href="#project">{% trans "Projects" %}</a></li>{% endif %}
                    {% if instance.show_search_organizations %}<li class="item aba"><a class="link-aba" href="#organization">{% trans "Organizations" %}</a></li>{% endif %}
                    {% if instance.show_search_investments %}<li class="item aba"><a class="link-aba" href="#investment">{% trans "Investments" %}</a></li>{% endif %}
                </ul>
            </div>

            <div class="opcoes">
                <!-- tipo -->
                <div class="tipo" style="display: none;">
                    <ul class="tipo-container" id="visualizacao-mapa">
                        <li class="item"><label><input type="radio" name="view" value="density" checked="checked" />{% trans "Density" %}</label></li>
                        <!--li class="item"><label><input type="radio" name="view" value="heat" />{% trans "Heat Map" %}</label></li-->
                    </ul>
                </div>
                <!-- fim de tipo mapa -->

                <!-- visualizacao -->
                <div class="visualizacao">
                    <p class="texto-lista">{% trans "View: " %}</p>
                    <ul class="visualizacao-container">
                        <li class="item ativo">
                            <a href="#mapa" class="link ico ico-texto mapa-icone ativo">{% trans "Map" %}
                            </a>
                        </li>

                        <li class="item inativo">
                            <a href="#graficos" class="link ico ico-texto grafico-icone inativo">{% trans "Chart" %}
                            </a>
                        </li> <!-- Para cada um desses, existe um icone inativo -->
                    </ul>
                </div>
                <!-- fim de visualizacao -->

                <!-- menu-auxiliar-mapa -->
                <div class="opcoes-adicionais">
                    <ul class="opcoes-adicionais-container">
                        <li class="item ico ico-texto relatorio"><a href="#">{% trans "Generate Report" %}</a></li>
                        <li class="item ico ico-texto impressao"><a href="#">{% trans "Print" %}</a></li>
                    </ul>
                </div>
                <!-- fim de operacoes-mapa -->
            </div>

            <div class="conteudo-abas-container">
                {% if instance.show_search_projects %}
                    {% addtoblock "js" %}
                    <script type="text/javascript">
                        jQuery(function ($) {
                            //if(document.location.href.indexOf('#filtro-investimentos')>0)
                              //  ecofundsMap.loadInvestments();
                            //else
                            //    ecofundsMap.loadProjects();
                        });
                    </script>
                    {% endaddtoblock %}

                    <section id="filtro-projetos">
                        {% include "project/advanced-search.html" %}
                    </section>
                {% endif %}

                {% if instance.show_search_organizations %}
                    <section id="filtro-organizacoes">
                        {% include "organization/advanced-search.html" %}
                    </section>
                {% endif %}

                {% if instance.show_search_investments %}
                    <section id="filtro-investimentos">
                        {% include "investment/advanced-search.html" %}
                    </section>
                {% endif %}
            </div>
        </div>
    </div>
{% endif %}

<section id="map-view" class="mapa">
    <div class="container">
        <div class="botoes-container">
            <a href="javascript:;" class="botao secundario destacado" id="bt-layers">{% trans "Add Layer" %}</a>
            <a href="javascript:;" class="botao secundario destacado" id="bt-fullscreen">{% trans "Full Screen" %}</a>
            <a href="javascript:;" class="botao secundario maptype" id="bt-terrain">{% trans "Map" %}</a>
            <a href="javascript:;" class="botao secundario selecionado maptype" id="bt-hybrid">{% trans "Satellite" %}</a>
        </div>

        <div class="slider-control-container">
            <div class="zoom-in"></div>
            <div class="slider-control"></div>
            <div class="zoom-out"></div>
        </div>

        <div class="legenda">
            <p>{% trans "Investments concentration:" %}</p>
            <div class="densidade">
                <span class="valor valor-inicial">0,000,000.00</span>
                <img class="cores" src="{% get_static_prefix %}images/bg/bg-legenda.png" alt="" />
                <span class="valor valor-final">0,000,000.00</span>
            </div>
        </div>
    </div>
    <div class="carregando tela-mapa" style="position:absolute;width:100%;"></div>
    <div style="position:relative;width:100%;height:400px;" class="gmap" id="id_map">
        <div style="position:absolute;width:100%;height:100%"></div>
    </div>
</section>

<section id="chart-view" class="graficos">
    <div class="container">
        <div class="botoes-container">
            <a href="javascript:;" class="botao secundario btn-regiao">{% trans "Location" %}</a>
            <a href="javascript:;" class="botao secundario btn-tipo-atividades">{% trans "Activity type" %}</a>
            <a href="javascript:;" class="botao secundario btn-investimentos selecionado">{% trans "Investments" %}</a>
        </div>

        <!-- visualizacao tipo de graficos -->
        <div class="visualizacao">
            <p class="texto-lista">{% trans "Chart type: " %}</p>
            <ul class="visualizacao-container">
                <li class="item ativo">
                    <a href="#bars" class="link ico ico-texto grafico-barra-icone ativo">{% trans "Bars" %}
                    </a>
                </li>

                <li class="item inativo">
                    <a href="#pie" class="link ico ico-texto grafico-pizza-icone inativo">{% trans "Pie" %}
                    </a>
                </li> <!-- Para cada um desses, existe um icone inativo -->
            </ul>
        </div>
        <!-- fim de visualizacao tipo de graficos-->

        <!-- O grafico Ã© gerado aqui -->
        <div id="chart-content" class="grafico-container"></div>
    </div>
</section>

<div id="info_text_labels" style="display: none;">
    <p id="title_project">{% trans "Total Projects" %}</p>
    <p id="title_investment">{% trans "Total Investments" %}</p>
    <p id="title_organization">{% trans "Organization name" %}</p>
</div>

{% verbatim %}
<div id="info_project" style="display: none;">
    <p>{{ label }} - {{ value }}</p>
</div>
<div id="info_organization" style="display: none;">
    <p>{{ value }}</p>
</div>
<div id="info_investment_density" style="display: none;">
    <p>{{ label }} - {{ value }}</p>
    <ul>
    {{#each projects}}
        <li>{{ acronym }} - {{ amount }}</li>
    {{/each}}
    </ul>
</div>
{% endverbatim %}
